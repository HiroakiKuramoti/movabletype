<mtapp:listing
   show_actions="0"
   type="templatemap">

  <div class="row">
    <div class="form-group col-9">

      <mtapp:setting
         id="archive-path"
         class="archive-path"
         label="<__trans phrase="Path">"
         label_for="archive-path"
         label_class="top-label"
         help_page="templates"
         help_section="archive_path">
        <select id="archive_file_sel_<mt:var name="map_id">" class="form-control tmpl-path" name="archive_file_sel_<mt:var name="map_id">" onchange="archiveFileSelect(this)">
        <mt:loop name="archive_tmpl_loop">
          <option value="<mt:var name="value" escape="html">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="name" escape="html"></option>
        </mt:loop>
          <option value=""><__trans phrase="Custom..."></option>
        </select>
        <input type="text" id="archive_file_tmpl_<mt:var name="map_id">" class="form-control tmpl-path tmpl-path-custom" name="archive_file_tmpl_<mt:var name="map_id">" value="<mt:var name="file_template" escape="html">" style="display:none;" />
      </mtapp:setting>

    </div>
    <div class="form-group col-1">

      <mtapp:setting
         id="archive-delete si"
         class="archive-delete si"
         help_page="templates"
         help_section="publish_options">
      <a href="javascript:void(0)" onclick="return deleteMap('<mt:var name="map_id">')"><mtapp:svgicon id="ic_trash" size="sm" title="$delete_button_title"></a></td>
    </mtapp:setting>

    </div>
    <div class="form-group col-2">

      <mtapp:setting
         id="archive-delete si"
         class="archive-delete si"
         help_page="templates"
         help_section="publish_options">
      <a class="btn btn-link" data-toggle="collapse" href="#edit-mapping-<mt:var name="map_id">" aria-expanded="false" aria-controls="edit-mapping-<mt:var name="map_id">">開閉</a></td>
    </mtapp:setting>

    </div>
  </div>
  <div class="collapse" id="edit-mapping-<mt:var name="map_id">">
    <div class="row">
      <div class="form-group col">

        <mtapp:setting
           id="archive-type"
           class="archive-type"
           label="<__trans phrase="Type">"
           label_for="archive-type"
           label_class="top-label"
           help_page="templates"
           help_section="archive_type">
        <mt:var name="archive_label">
        </mtapp:setting>

        <mtapp:setting
           id="cat_field_id_<mt:var name="map_id">"
           class="cat_field_id_<mt:var name="map_id">"
           label="<__trans phrase="Category Field">"
           label_for="cat_field_id_<mt:var name="map_id">"
           label_class="top-label"
           help_page="templates"
           help_section="cat_field_id"
           shown="$show_cat_field">
          <select name="cat_field_id_<mt:var name="map_id">" id="cat_field_id_<mt:var name="map_id">" tabindex="12" class="form-control">
            <mt:loop name='cat_fields'>
              <option value="<mt:var name="id">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="label"></option>
            </mt:loop>
          </select>
        </mtapp:setting>

        <mtapp:setting
           id="dt_field_id_<mt:var name="map_id">"
           class="dt_field_id_<mt:var name="map_id">"
           label="<__trans phrase="Date & Time Field">"
           label_for="dt_field_id_<mt:var name="map_id">"
           label_class="top-label"
           help_page="templates"
           help_section="dt_field_id"
           shown="$show_dt_field">
          <select name="dt_field_id_<mt:var name="map_id">" id="dt_field_id_<mt:var name="map_id">" tabindex="13" class="form-control">
            <mt:loop name='dt_fields'>
              <option value="<mt:var name="id">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="label"></option>
            </mt:loop>
          </select>
        </mtapp:setting>

      </div>
      <div class="form-group col">

        <mtapp:setting
           id="publish-options"
           class="publish-options"
           label="<__trans phrase="Publishing">"
           label_for="publish-options"
           label_class="top-label"
           help_page="templates"
           help_section="publish_options">
          <select name="map_build_type_<mt:var name="map_id">" id="build-type" class="form-control half-width">
            <option value="1"<mt:if name="map_build_type_1"> selected="selected"</mt:if>><__trans phrase="Statically (default)"></option>
          <mt:if name="publish_queue_available">
            <option value="4"<mt:if name="map_build_type_4"> selected="selected"</mt:if>><__trans phrase="Via Publish Queue"></option>
          <mt:ignore>
          <!-- untested features -->
            <option value="5"<mt:if name="map_build_type_5"> selected="selected"</mt:if>><__trans phrase="On a schedule"></option>
            <!-- This code needs to be shown if the "On a schedule" has been selected -->
            <__trans phrase=": every "><input name="schedule_interval" id="schedule_interval" value="<mt:var name="schedule_interval" escape="html">" maxlength="10" class="quarter-width" mt:watch-change="1" />
            <select name="schedule_period" id="schedule_period" class="form-control">
              <option value="minutes"<mt:if name="schedule_period_minutes"> selected="selected"</mt:if>><__trans phrase="minutes"></option>
              <option value="hours"<mt:if name="schedule_period_hours"> selected="selected"</mt:if>><__trans phrase="hours"></option>
              <option value="days"<mt:if name="schedule_period_days"> selected="selected"</mt:if>><__trans phrase="days"></option>
            </select>
          </mt:ignore>
          </mt:if>
            <option value="3"<mt:if name="map_build_type_3"> selected="selected"</mt:if>><__trans phrase="Dynamically"></option>
            <option value="2"<mt:if name="map_build_type_2"> selected="selected"</mt:if>><__trans phrase="Manually"></option>
            <option value="0"<mt:if name="map_build_type_0"> selected="selected"</mt:if>><__trans phrase="Do Not Publish"></option>
          </select>
        </mtapp:setting>

      </div>
    </div>
  </div>

</mtapp:listing>
