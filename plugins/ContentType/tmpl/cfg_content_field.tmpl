<mt:setvar name="page_title" value="<__trans phrase="Content Field Settings">">
<mt:setvar name="position_actions_bottom" value="1">
<mt:setvar name="screen_id" value="config-content-field">
<mt:setvar name="screen_class" value="content-field">
    
<mt:setvarblock name="system_msg">
<div id="msg-block"></div>
  <mt:if name="saved">
    <mtapp:statusmsg
       id="saved"
       class="success">
      <__trans phrase="Content Field settings has been saved.">
    </mtapp:statusmsg>
  </mt:if>
  <mt:if name="err_msg">
    <mtapp:statusmsg
       id="err_msg"
       class="error"
       can_close="0">
      <mt:var name="err_msg">
    </mtapp:statusmsg>
  </mt:if>
</mt:setvarblock>
        
<mt:setvarblock name="html_head" append="1">
<link rel="stylesheet" href="<$mt:var name="static_uri"$>plugins/ContentType/css/content-type.css?v=<$mt:var name="mt_version_id" escape="url"$>">
</mt:setvarblock>

<mt:setvarblock name="js_include" append="1">
<script type="text/javascript" src="<mt:var name="static_uri">plugins/ContentType/js/cms.js?v=<$mt:var name="mt_version_id" escape="url"$>"></script>
</mt:setvarblock>

<mt:include name="include/header.tmpl" id="header_include">

<mtapp:form id="content-field-form" name="content-field-form" mode="save_cfg_content_field">
  <input type="hidden" name="cfg_screen" value="cfg_content_field" />
  <input type="hidden" name="content_type_id" value="<mt:var name="content_type_id">" />
  <input type="hidden" name="id" value="<mt:var name="content_field_id">" />

  <mtapp:settinggroup id="content-field">

    <h2><__trans phrase="Content Field"></h2>

    <mtapp:setting
       id="name"
       label="<__trans phrase="Name">"
       required="1">
      <input type="text" name="name" id="name" class="text med required" value="<mt:var name="name" escape="html">" />
    </mtapp:setting>

    <mtapp:setting
       id="type"
       label="<__trans phrase="Content Field Type">"
       required="1">
      <select name="type" id="type">" class="half-width required">
      <option value=""><__trans phrase="Type is not selected"></option>
      <mt:loop name="content_field_types">
      <option value="<mt:var name="type">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="label"></option>
      </mt:loop>
      </select>
    </mtapp:setting>
<!--
    <mtapp:setting
       id="default"
       label="<__trans phrase="Default">">
      <input type="text" name="default" id="default" class="text med" value="<mt:var name="default" escape="html">" />
    </mtapp:setting>

    <mtapp:setting
       id="options"
       label="<__trans phrase="Options">">
      <input type="text" name="options" id="options" class="text med" value="<mt:var name="options" escape="html">" />
    </mtapp:setting>

    <mtapp:setting
      id="related_category_list_id"
      label="<__trans phrase="Related Category List">"
    >
      <select name="related_cat_list_id" id="related_cat_list_id" class="half-width">
        <option value=""><__trans phrase="Category List is not selected"></option>
      <mt:loop name="category_lists">
        <option value="<mt:var name="id">" <mt:if name="selected">selected="selected"</mt:if>><mt:var name="name"></option>
      </mt:loop>
      </select>
    </mtapp:setting>

    <mtapp:setting
       id="related_content_type_id"
       label="<__trans phrase="Related Content Type">">
      <select name="related_content_type_id" id="related_content_type_id">" class="half-width required">
      <option value=""><__trans phrase="Content Type is not selected"></option>
      <mt:loop name="content_types">
      <option value="<mt:var name="id">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="name"></option>
      </mt:loop>
      </select>
    </mtapp:setting>

    <mtapp:setting
       id="unique_key"
       label="<__trans phrase="Unique Key">">
      <mt:var name="unique_key" escape="html">
    </mtapp:setting>
-->

  <mt:if name="options_html"><mt:var name="options_html"></mt:if>

  </mtapp:settinggroup>

  <mt:setvarblock name="action_buttons">
    <button
       type="submit"
       accesskey="s"
       title="<__trans phrase="Save changes to these settings (s)">"
       class="save action primary button disabled">
      <__trans phrase="Save Changes">
    </button> 
    <button
       onclick="location.replace('<mt:var name="mt_url">?__mode=cfg_content_type&blog_id=<mt:var name="blog_id">&id=<mt:var name="content_type_id">')"
       type="button"
       accesskey="s"
       title="<__trans phrase="Back (b)">"
       class="goback action button">
      <__trans phrase="Back">
    </button> 
  </mt:setvarblock>
  <mt:include name="include/actions_bar.tmpl" bar_position="bottom" hide_pager="1" settings_bar="1">

</mtapp:form>

<mt:setvarblock name="jq_js_include" append="1">
  jQuery(function() {
    jQuery('input[type="text"]').keyup(function() {
      setDirty(true);
    });
    jQuery('select').change(function() {
      setDirty(true);
    });
  });

  jQuery('#content-field-form').submit( function() {
    if ( jQuery('#name').mtValidate('simple')
      &&  jQuery('#default').mtValid('simple')
      && jQuery('#related_content_type_id').mtValidate('simple') )
    { 
      setDirty(false);
      return true;
    } 
    return false;
  });

  // TODO: FIXME
  jQuery(function() {
    var contentFieldTypesOptions = <mt:var name="content_field_types_options">;
    jQuery('select#type').change(function() {
      jQuery.each( contentFieldTypesOptions, function( key, val ) {
          jQuery('#' + key + '-options').css( 'display', 'none' );
      });
      var selected = jQuery(this).val();
      if (selected && contentFieldTypesOptions[selected]) {
        jQuery('#' + selected + '-options').css( 'display', 'block' );
      }
    });
    jQuery('select#type').trigger('change');
  });
</mt:setvarblock>

<mt:include name="include/footer.tmpl">
